python
```python
class SegmentTree:
    """Segment tree supporting range sum queries and point updates."""
    def __init__(self, nums):
        self.n = len(nums)
        self.tree = [0] * (2 * self.n)
        self.tree[self.n:] = nums[:]
        for i in range(self.n - 1, 0, -1):
            self.tree[i] = self.tree[2 * i] + self.tree[2 * i + 1]

    def update(self, idx, val):
        i = idx + self.n
        self.tree[i] = val
        i //= 2
        while i:
            self.tree[i] = self.tree[2 * i] + self.tree[2 * i + 1]
            i //= 2

    def query(self, l, r):
        l += self.n; r += self.n
        res = 0
        while l <= r:
            if l & 1:
                res += self.tree[l]; l += 1
            if not (r & 1):
                res += self.tree[r]; r -= 1
            l //= 2; r //= 2
        return res
```
**Explanation:** Stores data in a flat array: leaves start at index n, parents combine children. Point updates refresh ancestors; range queries walk two pointers inward to accumulate sums.
**Complexity:** Time: O(log n) for update/query; Space: O(n).
**Example:**
Input: nums=[1,3,5], query(0,2)
Output: 9
**Notes:**
- Replace sum with min/max by changing the merge operation.
- Indices are zero-based and inclusive for queries.
- Add bounds checks in production code.
